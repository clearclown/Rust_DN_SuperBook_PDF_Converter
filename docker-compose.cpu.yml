# superbook-pdf CPU Override Configuration
# GPU設定を無効化してCPUのみで動作させる
# Issue #41: CUDAベースイメージに依存しないCPU専用ビルド
#
# Usage:
#   docker compose -f docker-compose.yml -f docker-compose.cpu.yml up -d
#   podman compose -f docker-compose.yml -f docker-compose.cpu.yml up -d

services:
  backend:
    # CPU専用Dockerfileでビルド (ubuntu:22.04 ベース、CUDA不要)
    build:
      context: superbook-pdf
      dockerfile: docker/backend/Dockerfile.cpu

    # GPU設定を削除
    deploy: {}

    environment:
      - SUPERBOOK_VENV=/app/ai_venv
      - SUPERBOOK_BIND=0.0.0.0
      - SUPERBOOK_PORT=8080
      - SUPERBOOK_WORK_DIR=/data/work
      - SUPERBOOK_NO_GPU=1
      - RUST_LOG=info
